<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>米哈遊課金CP值計算器</title>
    <meta name="description" content="使用這個工具來計算米哈遊遊戲中的課金性價比。">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        h1 {
            text-align: center;
            color: #2196F3;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        table {
            border-collapse: collapse;
            margin: 20px auto;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
            font-size: 0.9em;
        }
        th {
            background-color: #2196F3;
            color: white;
        }
        .checkbox-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .discount-column {
            width: 100px;
        }
        .discount-column input {
            width: 80%;
            box-sizing: border-box;
            padding: 5px;
            margin: 0 auto;
            display: block;
        }
        #globalYenToNtRate {
            max-width: 80px;
            margin-left: 10px;
        }
        .button-container, .toggle-button-container {
            display: flex;
            justify-content: center;
            gap: 10px; /* Spacing between buttons */
            margin-top: 20px;
        }
        .toggle-button, .toggle-currency-button, .toggle-yen-button, .toggle-yen-to-nt-button {
            text-align: center;
            padding: 10px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 150px; /* Make all buttons the same width */
        }
        .toggle-button:hover, .toggle-currency-button:hover, .toggle-yen-button:hover, .toggle-yen-to-nt-button:hover {
            background-color: #1976D2;
        }
        @media (min-width: 601px) {
            table {
                width: 80%;
            }
        }
        @media (max-width: 600px) {
            th, td {
                font-size: 0.7em;
                padding: 8px;
            }
            .toggle-button, .toggle-currency-button, .toggle-yen-button, .toggle-yen-to-nt-button {
                padding: 8px;
                width: 100%; /* Make buttons full width on smaller screens */
            }
            table {
                width: 100%;
            }
        }
    </style>
</head>
<body>
<h1>課金CP值計算器</h1>
<div class="checkbox-container">
    <input type="checkbox" id="doubleStonesCheckbox" onchange="toggleDoubleStones()">
    <label for="doubleStonesCheckbox">首儲</label>
</div>
<table>
    <thead>
        <tr>
            <th rowspan="2">石頭</th>
            <th class="main-table-currency-column" rowspan="2" style="display:none;">台幣</th>
            <th class="main-table-yen-column" rowspan="2" style="display:none;">日幣</th>
            <th class="main-table-yen-to-nt-column" rowspan="2">日幣轉台幣</th>
            <th rowspan="2">折價後</th>
            <th colspan="3">一顆石頭價格</th>
        </tr>
        <tr>
            <th class="currency-column">台幣</th>
            <th>日幣</th>
            <th>折價後</th>
        </tr>
    </thead>
    <tbody id="stoneTable">
        <!-- Rows will be inserted by JavaScript -->
    </tbody>
</table>
<div class="button-container">
    <button class="toggle-currency-button" onclick="toggleCurrencyColumn()">顯示台幣欄</button>
    <button class="toggle-yen-button" onclick="toggleYenColumn()">顯示日幣欄</button>
    <button class="toggle-yen-to-nt-button" onclick="toggleYenToNtColumn()">隱藏日幣轉台幣欄</button>
</div>
<div style="margin-top: 20px; text-align: center;">
    <label for="globalYenToNtRate">請輸入日幣轉台幣匯率:</label>
    <input type="number" value="0.2" step="0.01" id="globalYenToNtRate" oninput="calculatePrices()">
</div>
<div class="toggle-button-container">
    <button class="toggle-button" onclick="toggleDrawSettings()">顯示抽數價格</button>
</div>
<div id="drawSettings" style="display: none;">
    <table>
        <thead>
            <tr>
                <th rowspan="2">石頭</th>
                <th colspan="3" id="drawPriceHeader">幾抽價格</th>
            </tr>
            <tr>
                <th>台幣</th>
                <th>日幣</th>
                <th>折價後</th>
            </tr>
        </thead>
        <tbody id="xDrawPriceTable">
        </tbody>
    </table>
    <div style="margin-top: 20px; text-align: center;">
        <label for="drawCount">請輸入抽數:</label>
        <input type="number" value="10" step="1" min="1" id="drawCount" oninput="calculatePrices()">
    </div>
</div>
<script>
    const stoneData = [
        { stoneCount: 8080, ntPrice: 3290, yenPrice: 12000 },
        { stoneCount: 3940, ntPrice: 1690, yenPrice: 6100 },
        { stoneCount: 2240, ntPrice: 990, yenPrice: 3680 },
        { stoneCount: 1090, ntPrice: 490, yenPrice: 1840 },
        { stoneCount: 300, ntPrice: 170, yenPrice: 610 },
        { stoneCount: 60, ntPrice: 33, yenPrice: 120 }
    ];
    function initTable() {
        const tableBody = document.getElementById('stoneTable');
        tableBody.innerHTML = '';
        stoneData.forEach((data, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td id="stoneCount-${index}">${data.stoneCount}</td>
                <td class="main-table-currency-column" style="display:none;">${data.ntPrice}</td>
                <td class="main-table-yen-column" style="display:none;">${data.yenPrice}</td>
                <td id="yenToNt-${index}" class="main-table-yen-to-nt-column"></td>
                <td class="discount-column"><input type="number" value="0" step="0.01" id="discountPrice-${index}" oninput="calculatePrices()"></td>
                <td class="currency-column" id="ntPerStone-${index}"></td>
                <td id="yenPerStone-${index}"></td>
                <td id="discountPerStone-${index}"></td>
            `;
            tableBody.appendChild(row);
        });
        calculatePrices();
    }
    function calculatePrices() {
        const exchangeRate = parseFloat(document.getElementById('globalYenToNtRate').value) || 0;
        const drawCount = parseInt(document.getElementById('drawCount').value) || 10;
        document.getElementById('drawPriceHeader').textContent = `${drawCount}抽價格`;
        const xDrawPriceTableBody = document.getElementById('xDrawPriceTable');
        xDrawPriceTableBody.innerHTML = '';
        stoneData.forEach((data, index) => {
            let stoneCount = data.stoneCount;
            const ntPrice = data.ntPrice;
            const yenPrice = data.yenPrice;
            if (document.getElementById('doubleStonesCheckbox').checked) {
                stoneCount *= 2;
            }
            const discountPrice = parseFloat(document.getElementById(`discountPrice-${index}`).value) || 0;
            const yenToNt = Math.round(yenPrice * exchangeRate);
            const ntPerStone = ntPrice / stoneCount;
            const yenPerStone = yenToNt / stoneCount;
            const discountPerStone = discountPrice / stoneCount || 0;
            document.getElementById(`stoneCount-${index}`).textContent = stoneCount;
            document.getElementById(`yenToNt-${index}`).textContent = yenToNt;
            document.getElementById(`ntPerStone-${index}`).textContent = ntPerStone.toFixed(3);
            document.getElementById(`yenPerStone-${index}`).textContent = yenPerStone.toFixed(3);
            document.getElementById(`discountPerStone-${index}`).textContent = discountPerStone.toFixed(3);
            const requiredStones = drawCount * 160;
            const xDrawNtPrice = Math.round(ntPerStone * requiredStones);
            const xDrawYenPrice = Math.round(yenPerStone * requiredStones);
            const xDrawDiscountPrice = Math.round(discountPerStone * requiredStones);
            const xDrawRow = document.createElement('tr');
            xDrawRow.innerHTML = `
                <td>${stoneCount}</td>
                <td>${xDrawNtPrice}</td>
                <td>${xDrawYenPrice}</td>
                <td>${xDrawDiscountPrice || 0}</td>
            `;
            xDrawPriceTableBody.appendChild(xDrawRow);
        });
    }
    function toggleDoubleStones() {
        calculatePrices();
    }
    function toggleDrawSettings() {
        const drawSettings = document.getElementById('drawSettings');
        const button = document.querySelector('.toggle-button');
        const isHidden = drawSettings.style.display === 'none' || drawSettings.style.display === '';
        drawSettings.style.display = isHidden ? 'block' : 'none';
        button.textContent = isHidden ? '隱藏抽數價格' : '顯示抽數價格';
    }
    function toggleCurrencyColumn() {
        const currencyColumns = document.querySelectorAll('.main-table-currency-column');
        currencyColumns.forEach(column => {
            column.style.display = column.style.display === 'none' ? '' : 'none';
        });
        const button = document.querySelector('.toggle-currency-button');
        const isHidden = currencyColumns[0].style.display === 'none';
        button.textContent = isHidden ? '顯示台幣欄' : '隱藏台幣欄';
    }
    function toggleYenColumn() {
        const yenColumns = document.querySelectorAll('.main-table-yen-column');
        yenColumns.forEach(column => {
            column.style.display = column.style.display === 'none' ? '' : 'none';
        });
        const button = document.querySelector('.toggle-yen-button');
        const isHidden = yenColumns[0].style.display === 'none';
        button.textContent = isHidden ? '顯示日幣欄' : '隱藏日幣欄';
    }
    function toggleYenToNtColumn() {
        const yenToNtColumns = document.querySelectorAll('.main-table-yen-to-nt-column');
        yenToNtColumns.forEach(column => {
            column.style.display = column.style.display === 'none' ? '' : 'none';
        });
        const button = document.querySelector('.toggle-yen-to-nt-button');
        const isHidden = yenToNtColumns[0].style.display === 'none';
        button.textContent = isHidden ? '顯示日幣轉台幣欄' : '隱藏日幣轉台幣欄';
    }
    initTable();
</script>
</body>
</html>
